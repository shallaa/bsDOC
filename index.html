<!DOCTYPE html>
<html lang="ko">
<head>
<title>bsDOC Home</title>
<meta charset="utf-8"/>
<style type="text/css">
#preloader{font-size:1em;text-align:center;margin:auto}
#stage{display:none}
</style>
</head>
<body>
<div id="preloader">Loading...</div>
<div id="stage">
	<h1>projectBS Document System</h1>
	<div id="left"><div id="contents"></div></div>
	<div id="right"><div id="doc"></div></div>
</div>
<script src="../bsJS/bsjs.0.5.js"></script>
<script>
bs.plugin('markdown');
bs(function(){
	var index = {}, start, load, t0 = 'bsJS,bsPHP'.split(','), i = 0, j = t0.length, k = 0;
	load = function(v){
		bs.get( function(data){
			var str, t0, key, items = {}, menu = [];
			index[v] = t0 = JSON.parse(data);
			str = '<div>' + v + ' <select id="' + v + '_ver"><option value="">version</option>';
			for( key in t0 ) str += '<option value="' + key + '">' + key + '</option>', items[key] = t0[key];
			bs.Dom(str + '</select>').S( '<', '#contents', 'change', function(e){
				var str, ver = bs.Dom('#' + v + '_ver').S('@value'), t0 = items[ver], t1 = [], t2, t3, i, j;
				if( !t0 ) return bs.Dom('#' + v + '_list').S('html','');
				for( i in t0 ) t1[t1.length] = i;
				for( str = '', t1.sort(), i = 0, j = t1.length ; i < j ; i++ ){
					str += '<div>' + t1[i] + '</div><ul>';
					for( t2 = t0[t1[i]], k = 0, l = t2.length ; k < l ; k++ ) t3 = t2[k], str += '<li data-path="' + [v, ver, t1[i].split('.')[1], t3].join('/') + '">' + t3 + '</li>';
					str += '</ul>'
				}
				bs.Dom('#' + v + '_list').S( 'html', str );
				bs.Dom('[data-path^=' + v + ']').S( 'cursor', 'pointer', 'down', function(e){
					bs.get( function(data){
						bs.Dom('#doc').S( 'html', bs.markdown(data) );
					}, bs.Dom(this).S('*path')+'.html' );
				} );
			} );
			bs.Dom('<ul id="' + v + '_list"></ul>').S( '<', '#contents' );
			if( ++k == j ) setTimeout( start, 1 );
		}, v + '/index.json' );
	};
	while( i < j ) load(t0[i++]);
	start = function(){
		bs.Css('h1').S( 'text-align', 'center', 'font-size', '1.5em' ),
		bs.Css('#stage').S( 'margin', '0 auto', 'width', '100%', 'max-width', '960px' ),
		bs.Css('#left').S( 'width', '20%', 'float', 'left', 'font-size', '1em', 'overflow', 'hidden', 'background', '#eee' ),
		bs.Css('#contents').S( 'margin', '0.5em' ),
		bs.Css('#right').S( 'width', '80%', 'float', 'left', 'font-size', '1.2em', 'overflow', 'hidden' ),
		bs.Css('#doc').S( 'margin', '0.5em' ),
		bs.Dom('#preloader').S( 'display', 'none' ),
		bs.Dom('#stage').S( 'display', 'block' ),
		bs.router( 'path', 'controller/path.json', 'start' );
	}
});
</script>
</body>
</html>