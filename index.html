<!DOCTYPE html>
<html lang="ko">
<head>
<title>bsDOC - projectBS Document System</title>
<meta name="keywords" content="bsDOC" />
<meta name="description" content="bsDOC - projectBS Document System" />
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="format-detection" content="telephone=no" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,target-densitydpi=medium-dpi" />
<link rel="shortcut icon" href="http://blog.bsidesoft.com/favicon.ico" type="image/x-icon">
</head>
<body>

<style type="text/css">
#preloader{font-size:1em;text-align:center;margin:auto}
#stage{display:none}
</style>

<div id="preloader">Loading...</div>
<div id="stage">
	<h1>projectBS Document System</h1>
	<div id="left"><div id="contents"></div></div>
	<div id="right"><div id="doc"></div></div>
</div>

<script src="../bsJS/bsjs.0.5.js"></script><script>
bs.plugin('markdown'),
bs(function(){

	SUB_PROJECTS:
	var PROJECT = 'projectBS,bsJS,bsPHP'.split(',');
	
	STARTER:
	var start = function(){
		
		CSS:
		bs.Css('h1').S( 'text-align', 'center', 'font-size', '1.5em' ),
		bs.Css('#stage').S( 'margin', '0 auto', 'width', '100%', 'max-width', '960px' ),
		bs.Css('#left').S( 'width', '20%', 'float', 'left', 'font-size', '1em', 'background', '#eee' ),
		bs.Css('#contents').S( 'overflow', 'hidden', 'margin', '0.5em' ),
		bs.Css('#right').S( 'width', '80%', 'float', 'left', 'font-size', '1.2em' ),
		bs.Css('#doc').S( 'overflow', 'hidden', 'margin', '0.5em' );
		
		OPEN:
		bs.Dom('#preloader').S( 'display', 'none' ),
		bs.Dom('#stage').S( 'display', 'block' );
			
		ROUTING:
		uri.base = location.pathname, uri.base = uri.base.substr( uri.base.lastIndexOf('/') + 1 ) + '#!',
		bs.router( '*', function(){
			bs.get( function(data){bs.Dom('#doc').S( 'html', bs.markdown(data) );}, Array.prototype.join.call( arguments, '/' ) + '.html' );
		}, 'start', function(){location.hash ? bs.router('change') : uri('intro');} );
		
	},
	loader = function(v){
		bs.get( function(data){
			var items = {}, t0 = index[v] = JSON.parse(data), ver = t0.version, str, key;
			delete t0.version;
			if( ver ){
				str = '<div>' + v + ' <select id="' + v + '_ver"><option value="">version</option>';
				for( key in t0 ) str += '<option value="' + key + '">' + key + '</option>', items[key] = t0[key];
				bs.Dom('#contents').S( 'html+', str + '</select></div>' );
				bs.Dom('#' + v + '_ver').S( '<', '#contents', 'change', function(e){
					var str, ver = bs.Dom('#' + v + '_ver').S('@value'), t0 = items[ver], t1 = [], t2, t3, i, j;
					if( !t0 ) return bs.Dom('#' + v + '_list').S('html','');
					for( i in t0 ) t1[t1.length] = i;
					for( str = '', t1.sort(), i = 0, j = t1.length ; i < j ; i++ ){
						t2 = t0[t1[i]];
						for( str += '<li>' + t1[i] + '<ul>', k = 0, l = t2.length ; k < l ; k++ ) t3 = t2[k], str += '<li data-path="' + [v, ver, bs.trim(t1[i].split('.')[1]), t3].join('/') + '">' + t3 + '</li>';
						str += '</ul></li>'
					}
					bs.Dom('#' + v + '_list').S( 'html', str ),
					bs.Dom('[data-path^=' + v + ']').S( 'cursor', 'pointer', 'down', jump );
				} );
			}else{
				bs.Dom( '<div>' + v + '</div>' ).S( '<', '#contents', 'cursor', 'pointer', 'down', function(e){
					var t1, i, j;
					t1 = [];
					for( i in t0 ) t1[t1.length] = i;
					for( t1.sort(), i = 0, j = t1.length ; i < j ; i++ ){
						bs.Dom('<li data-path="' + [v, t0[t1[i]]].join('/') + '">' + t1[i] + '</li>').S('<','#' + v + '_list');
					}
					bs.Dom('[data-path^=' + v + ']').S( 'cursor', 'pointer', 'down', jump );
				});
			}
			bs.Dom('<ul id="' + v + '_list"></ul>').S( '<', '#contents' );
			++PROJECT.count == PROJECT.length ? start() : loader(PROJECT[PROJECT.count]);
		}, v + '/index.json' );
	},
	uri = function(v){location.href = uri.base + v;},
	jump = function(e){uri(bs.Dom(this).S('*path'));},
	index = {};
	
	LOADING:
	loader(PROJECT[PROJECT.count = 0]);
});
</script>
</body>
</html>